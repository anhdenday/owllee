<!DOCTYPE html>
<html>
<head>
    <title>LMS VinSchool Assistant</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #F6F7FB;
            min-height: 100vh;
            min-width: 100vw;
        }
        /* Wrapper cƒÉn gi·ªØa */
        .main-center-wrapper {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            width: 100vw;
            position: relative;
        }
        /* H√¨nh LMS n·ªÅn ch√≠nh */
        .lms-content-img {
            width: 100%;
            max-width: 1440px;
            min-width: 320px;
            height: auto;
            margin: 0 auto;
            display: block;
            box-shadow: 0 0 18px #0001;
            border-radius: 12px;
            z-index: 1;
        }
        /* Bong b√≥ng Edubot cƒÉn theo n·ªôi dung */
        #custom-edubot-bubble {
            position: fixed;
            right: max(calc((100vw - 1440px) / 2 + 32px), 24px);
            bottom: 40px;
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: #3071FF;
            color: #fff;
            box-shadow: 0 4px 16px #0002;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            z-index: 12000;
            transition: background 0.2s;
            user-select: none;
        }
        #custom-edubot-bubble:hover {
            background: #18459b;
        }
        #custom-edubot-bubble .edubot-icon {
            font-size: 36px;
            margin-right: 6px;
        }
        /* Menu ch·ªçn bot cƒÉn theo n·ªôi dung */
        #edubot-menu {
            position: fixed;
            right: max(calc((100vw - 1440px) / 2 + 32px), 24px);
            bottom: 140px;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 6px 32px #0003;
            padding: 12px 0;
            min-width: 220px;
            display: none;
            flex-direction: column;
            z-index: 13000;
            border: 1px solid #eee;
        }
        .edubot-menu-item {
            padding: 14px 28px;
            font-size: 16px;
            color: #3071FF;
            cursor: pointer;
            background: #fff;
            border: none;
            text-align: left;
            outline: none;
            transition: background 0.18s;
        }
        .edubot-menu-item:hover {
            background: #eaf2ff;
        }
        .edubot-menu-title {
            padding: 8px 28px;
            font-size: 15px;
            font-weight: bold;
            color: #222;
            margin-bottom: 5px;
        }
        /* N√∫t ƒë√≥ng popup */
        #edubot-menu-close {
            position: absolute;
            top: 7px;
            right: 13px;
            font-size: 22px;
            color: #aaa;
            cursor: pointer;
            background: none;
            border: none;
            z-index: 1;
        }
        #edubot-menu-close:hover {
            color: #f44336;
        }

        /* Responsive: max-width nh·ªè th√¨ thu h·∫πp l·∫°i */
        @media (max-width: 1550px) {
            #custom-edubot-bubble, #edubot-menu {
                right: 24px !important;
            }
        }
        @media (max-width: 1024px) {
            .main-center-wrapper { min-height: unset; }
            .lms-content-img {
                max-width: 100vw;
                border-radius: 0;
            }
            #custom-edubot-bubble, #edubot-menu {
                right: 12px !important;
                bottom: 20px !important;
            }
            #edubot-menu {
                bottom: 110px !important;
            }
        }
        @media (max-width: 600px) {
            #custom-edubot-bubble, #edubot-menu {
                width: 58px;
                height: 58px;
                min-width: 58px;
                font-size: 14px;
            }
            #custom-edubot-bubble .edubot-icon { font-size: 22px; }
            #edubot-menu { min-width: 140px; font-size: 13px; }
        }
    </style>
</head>
<body>
   <div class="main-center-wrapper">
      <!-- Ch·ªâ c√≤n l√† n·ªôi dung LMS -->
      <img src="https://github.com/anhdenday/owllee/blob/main/LMS/LMS.png?raw=true" class="lms-content-img" alt="LMS VinSchool Assistant">
   </div>

   <!-- Bong b√≥ng Edubot -->
   <div id="custom-edubot-bubble" onclick="toggleMenu()">
      <span class="edubot-icon">ü§ñ</span> Edubot
   </div>

   <!-- Menu ch·ªçn bot -->
   <div id="edubot-menu">
      <button id="edubot-menu-close" onclick="closeMenu()">&times;</button>
      <div class="edubot-menu-title">Ch·ªçn tr·ª£ l√Ω Edubot</div>
      <button class="edubot-menu-item" onclick="selectBot('student')">Edubot - h·ªçc sinh</button>
      <button class="edubot-menu-item" onclick="selectBot('parent')">Edubot - Ph·ª• huynh</button>
   </div>

   <script>
    // C·∫•u h√¨nh bot
    const botConfigs = {
      student: {
        id: '68873896a5ab5e110336bd56'
      },
      parent: {
        id: '68898ff05799bf80be10a78a'
      }
    };

    // Tr·∫°ng th√°i menu
    function toggleMenu() {
      const menu = document.getElementById('edubot-menu');
      menu.style.display = (menu.style.display === "flex") ? "none" : "flex";
    }
    function closeMenu() {
      document.getElementById('edubot-menu').style.display = "none";
    }
    // Click ngo√†i menu s·∫Ω t·ª± ƒë√≥ng
    document.addEventListener('click', function(e) {
      const menu = document.getElementById('edubot-menu');
      const bubble = document.getElementById('custom-edubot-bubble');
      if (
        menu.style.display === "flex" &&
        !menu.contains(e.target) &&
        !bubble.contains(e.target)
      ) {
        menu.style.display = "none";
      }
    });

    // Xo√° bot c≈©
    function removeOwllaBot() {
      // Xo√° script
      document.querySelectorAll('script[data-chat-service]').forEach(el => el.remove());
      // Xo√° c√°c iframe ho·∫∑c div popup chatbot
      document.querySelectorAll('iframe[src*="agent.owllee.io"], .owlla-chatbot-bubble, .owlla-chatbot-container').forEach(el => el.remove());
    }

    // H√†m ·∫©n bong b√≥ng m·∫∑c ƒë·ªãnh Owllee (CSS ho·∫∑c x√≥a node)
    function hideDefaultOwllaBubble() {
      // CSS c·ª©ng ƒë·ªÉ ·∫©n m·ªçi bubble c·ªßa Owllee
      let css = `
      .owlla-chatbot-bubble,
      .owlla-chatbot-bubble *, 
      .owlla-chatbot-bubble[style] { display:none!important; opacity:0!important; pointer-events:none!important; }
      `;
      let style = document.getElementById('owlla-hide-bubble');
      if (!style) {
        style = document.createElement('style');
        style.id = 'owlla-hide-bubble';
        style.innerHTML = css;
        document.head.appendChild(style);
      }
      // Ngo√†i ra, x√≥a node bubble c·ª©ng n·∫øu c√≥
      setTimeout(() => {
        document.querySelectorAll('.owlla-chatbot-bubble').forEach(el => el.remove());
      }, 500);
    }

    // H√†m t·ª± ƒë·ªông click m·ªü chat (n·∫øu c·∫ßn, Owllee kh√¥ng c√≥ h√†m open public)
    function autoOpenOwllaChat() {
      setTimeout(() => {
        let bubble = document.querySelector('.owlla-chatbot-bubble');
        if (bubble) {
          bubble.click();
        } else {
          setTimeout(() => {
            let bubble2 = document.querySelector('.owlla-chatbot-bubble');
            if (bubble2) bubble2.click();
          }, 400);
        }
      }, 600); // Ch·ªù cho owllee load h·∫øt UI m·ªõi click
    }

    // Load bot v√† m·ªü chat ngay, ·∫©n bubble m·∫∑c ƒë·ªãnh
    function selectBot(type) {
      closeMenu();
      removeOwllaBot();
      hideDefaultOwllaBubble(); // G·∫Øn css tr∆∞·ªõc
      setTimeout(() => {
        const script = document.createElement('script');
        script.src = "https://agent.owllee.io/resources/statics/cdn/owlla_chatbot.js";
        script.setAttribute('data-chat-service', 'Salebot');
        script.setAttribute('data-bot-id', botConfigs[type].id);
        script.setAttribute('data-chat-domain', 'https://agent.owllee.io');
        script.setAttribute('data-chat-width', '450px');
        script.setAttribute('data-chat-height', '600px');
        script.setAttribute('data-bubble-color', '#3071FF');
        script.setAttribute('data-hide-bubble', 'true'); // Owllee ch∆∞a support, ph√≤ng khi c√≥
        document.body.appendChild(script);

        setTimeout(() => {
          hideDefaultOwllaBubble();
          autoOpenOwllaChat();
        }, 1500);
      }, 120);
    }
   </script>
</body>
</html>
